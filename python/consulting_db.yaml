# Consulting Firm Client Engagements Database
# 13 tables across static (generated once) and dynamic (simulation-populated) categories

entities:
  # ============================================================
  # PHASE 1: STATIC TABLES (generated at DB creation time)
  # ============================================================

  # Table 1: Location
  - name: Location
    type: entity
    rows: 30
    attributes:
      - name: LocationID
        type: pk
      - name: State
        type: string
        generator:
          type: faker
          method: location.state()
      - name: City
        type: string
        generator:
          type: faker
          method: location.city()

  # Table 2: Client
  - name: Client
    type: entity
    rows: 20
    attributes:
      - name: ClientID
        type: pk
      - name: ClientName
        type: string
        generator:
          type: faker
          method: company.name()
      - name: LocationID
        type: fk
        ref: Location.LocationID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: PhoneNumber
        type: string
        generator:
          type: faker
          method: phone.number()
      - name: Email
        type: string
        generator:
          type: faker
          method: internet.email()

  # Table 3: BusinessUnit (deterministic, 5 fixed rows)
  - name: BusinessUnit
    type: entity
    rows: 5
    attributes:
      - name: BusinessUnitID
        type: pk
      - name: BusinessUnitName
        type: string
        generator:
          type: distribution
          formula: DISC(0.2, Retail, 0.2, Healthcare, 0.2, Media & Entertainment, 0.2, Energy, 0.2, Government)

  # Table 4: Title (deterministic, 6 fixed rows)
  - name: Title
    type: entity
    rows: 6
    attributes:
      - name: TitleID
        type: pk
      - name: TitleName
        type: string
        generator:
          type: distribution
          formula: DISC(0.167, Consultant, 0.167, Senior Consultant, 0.167, Manager, 0.167, Senior Manager, 0.166, Associate Partner, 0.166, Partner)

  # Table 5: Consultant (resource table for simulation)
  - name: Consultant
    type: resource
    rows: 60
    attributes:
      - name: ConsultantID
        type: pk
      - name: FirstName
        type: string
        generator:
          type: faker
          method: person.firstName()
      - name: LastName
        type: string
        generator:
          type: faker
          method: person.lastName()
      - name: Email
        type: string
        generator:
          type: faker
          method: internet.email()
      - name: Phone
        type: string
        generator:
          type: faker
          method: phone.number()
      - name: BusinessUnitID
        type: fk
        ref: BusinessUnit.BusinessUnitID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: resource_type
        type: resource_type
        generator:
          type: distribution
          formula: DISC(0.30, Junior, 0.30, Mid, 0.20, Senior, 0.10, Lead, 0.05, Principal, 0.05, Executive)

  # Table 6: Consultant_Title_History (bridge - populated by post-processing script)
  # Complex promotion-chain logic: 1-3 rows per consultant
  - name: Consultant_Title_History
    type: bridge
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: ConsultantID
        type: resource_id
        ref: Consultant.ConsultantID
      - name: TitleID
        type: fk
        ref: Title.TitleID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: StartDate
        type: date
      - name: EndDate
        type: date
      - name: Salary
        type: decimal(12,2)
      - name: event_type
        type: event_type

  # ============================================================
  # PHASE 2: PROJECT TABLES (Dynamic â€” populated by simulation)
  # ============================================================

  # Table 7: Project
  - name: Project
    type: entity
    rows: n/a
    attributes:
      - name: ProjectID
        type: pk
      - name: ClientID
        type: fk
        ref: Client.ClientID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: BusinessUnitID
        type: fk
        ref: BusinessUnit.BusinessUnitID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: ProjectName
        type: string
        generator:
          type: faker
          method: company.catchPhrase()
      - name: ProjectType
        type: string
        generator:
          type: distribution
          formula: DISC(0.5, Fixed-Price, 0.5, Time & Materials)
      - name: Fixed_Price_Amount
        type: decimal(12,2)
        generator:
          type: distribution
          formula: UNIF(50000, 500000)
      - name: PlannedStartDate
        type: date
      - name: PlannedEndDate
        type: date
      - name: PlannedExpense
        type: decimal(12,2)
      - name: ProjectStatus
        type: string
      - name: created_at
        type: datetime

  # Table 8: ProjectBillingRate
  - name: ProjectBillingRate
    type: bridge
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: ProjectID
        type: entity_id
        ref: Project.ProjectID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: TitleID
        type: fk
        ref: Title.TitleID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: BillingRate
        type: decimal(10,2)
        generator:
          type: distribution
          formula: NORM(275, 50)
      - name: event_type
        type: event_type

  # Table 9: Deliverable
  - name: Deliverable
    type: entity
    rows: n/a
    attributes:
      - name: DeliverableID
        type: pk
      - name: ProjectID
        type: entity_id
        ref: Project.ProjectID
        generator:
          type: foreign_key
          subtype: one_to_many
      - name: DeliverableName
        type: string
        generator:
          type: distribution
          formula: DISC(0.2, Project Plan Development, 0.2, Design, 0.2, Infrastructure Implementation, 0.2, Coding and Unit Test, 0.2, System Test)
      - name: PlannedStartDate
        type: date
      - name: PlannedEndDate
        type: date
      - name: ActualStartDate
        type: date
      - name: ActualEndDate
        type: date
      - name: created_at
        type: datetime

  # Table 10: Deliverable_Title_Plan_Mapping
  - name: Deliverable_Title_Plan_Mapping
    type: bridge
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: DeliverableID
        type: entity_id
        ref: Deliverable.DeliverableID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: TitleID
        type: fk
        ref: Title.TitleID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: PlannedHours
        type: decimal(10,2)
        generator:
          type: distribution
          formula: UNIF(30, 120)
      - name: event_type
        type: event_type

  # Table 11: Consultant_Deliverable_Mapping
  - name: Consultant_Deliverable_Mapping
    type: bridge
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: DeliverableID
        type: entity_id
        ref: Deliverable.DeliverableID
      - name: ConsultantID
        type: resource_id
        ref: Consultant.ConsultantID
      - name: Month
        type: date
      - name: Hours
        type: decimal(10,2)
        generator:
          type: distribution
          formula: UNIF(20, 160)
      - name: event_type
        type: event_type
      - name: start_date
        type: datetime
      - name: end_date
        type: datetime

  # Table 12: ProjectExpense
  - name: ProjectExpense
    type: entity
    rows: n/a
    attributes:
      - name: ExpenseID
        type: pk
      - name: ProjectID
        type: entity_id
        ref: Project.ProjectID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: Date
        type: date
      - name: Amount
        type: decimal(10,2)
        generator:
          type: distribution
          formula: NORM(5000, 2000)
      - name: Description
        type: string
        generator:
          type: faker
          method: commerce.productName()
      - name: Category
        type: string
        generator:
          type: distribution
          formula: DISC(0.3, Travel, 0.25, Software, 0.2, Equipment, 0.15, Facilities, 0.1, Other)
      - name: Billable
        type: string
        generator:
          type: distribution
          formula: DISC(0.7, Billable, 0.3, Non-Billable)
      - name: created_at
        type: datetime

  # Table 13: Deliverable_Progress_Month
  - name: Deliverable_Progress_Month
    type: bridge
    rows: n/a
    attributes:
      - name: id
        type: pk
      - name: DeliverableID
        type: entity_id
        ref: Deliverable.DeliverableID
        generator:
          type: foreign_key
          subtype: many_to_one
      - name: Report_Month
        type: date
      - name: PercentageComplete
        type: decimal(5,2)
        generator:
          type: distribution
          formula: UNIF(0, 100)
      - name: event_type
        type: event_type
